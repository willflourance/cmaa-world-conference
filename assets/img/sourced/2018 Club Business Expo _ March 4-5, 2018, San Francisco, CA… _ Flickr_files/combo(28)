YUI.add("hermes-template-album-page",function(e,t){var a=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,a,l,n){var u=null!=t?t:{},o=a.helperMissing,r=e.escapeExpression;return r((a.outlet||t&&t.outlet||o).call(u,null!=t?t["global-nav-view"]:t,{name:"outlet",hash:{},data:n}))+'\n\n<div role="main" class="album-container fluid-centered">\n\t'+r((a.outlet||t&&t.outlet||o).call(u,null!=t?t["album-toolbar-view"]:t,{name:"outlet",hash:{},data:n}))+"\n\t"+r((a.outlet||t&&t.outlet||o).call(u,null!=t?t["album-header-view"]:t,{name:"outlet",hash:{},data:n}))+"\n\t"+r((a.outlet||t&&t.outlet||o).call(u,null!=t?t["photo-list-view"]:t,{name:"outlet",hash:{},data:n}))+"\n\t"+r((a.outlet||t&&t.outlet||o).call(u,null!=t?t["pagination-view"]:t,{name:"outlet",hash:{},data:n}))+"\n\n</div>\n"+r((a.outlet||t&&t.outlet||o).call(u,null!=t?t["signup-footer-view"]:t,{name:"outlet",hash:{},data:n}))+"\n"+r((a.outlet||t&&t.outlet||o).call(u,null!=t?t["footer-full-view"]:t,{name:"outlet",hash:{},data:n}))},useData:!0}),l={};e.Array.each([],function(t){var a=e.Template.get("hermes/"+t);a&&(l[t]=a)}),e.Template.register("hermes/album-page",function(t,n){return n=n||{},n.partials=n.partials?e.merge(l,n.partials):l,a(t,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-dynamic-page-head",function(n,a){var e=n.Template.Handlebars.revive({1:function(n,a,e,l,t){var r;return'<meta name="title" content="'+n.escapeExpression("function"==typeof(r=null!=(r=e.title||(null!=a?a.title:a))?r:e.helperMissing)?r.call(null!=a?a:{},{name:"title",hash:{},data:t}):r)+'" data-dynamic="true">'},3:function(n,a,e,l,t){return'<meta name="description" content="'+n.escapeExpression((e.stripTags||a&&a.stripTags||e.helperMissing).call(null!=a?a:{},null!=a?a.description:a,{name:"stripTags",hash:{},data:t}))+'" data-dynamic="true">'},5:function(n,a,e,l,t){var r;return'<meta property="og:title" content="'+n.escapeExpression("function"==typeof(r=null!=(r=e.title||(null!=a?a.title:a))?r:e.helperMissing)?r.call(null!=a?a:{},{name:"title",hash:{},data:t}):r)+'" data-dynamic="true">'},7:function(n,a,e,l,t){return'<meta property="og:description" content="'+n.escapeExpression((e.stripTags||a&&a.stripTags||e.helperMissing).call(null!=a?a:{},null!=a?a.description:a,{name:"stripTags",hash:{},data:t}))+'" data-dynamic="true">'},9:function(n,a,e,l,t){var r;return'<meta property="og:type" content="flickr_photos:'+n.escapeExpression("function"==typeof(r=null!=(r=e.flickrType||(null!=a?a.flickrType:a))?r:e.helperMissing)?r.call(null!=a?a:{},{name:"flickrType",hash:{},data:t}):r)+'" data-dynamic="true">'},11:function(n,a,e,l,t){var r;return'<meta property="og:type" content="'+n.escapeExpression("function"==typeof(r=null!=(r=e.ogType||(null!=a?a.ogType:a))?r:e.helperMissing)?r.call(null!=a?a:{},{name:"ogType",hash:{},data:t}):r)+'" data-dynamic="true">'},13:function(n,a,e,l,t){var r;return'<meta property="og:url" content="'+n.escapeExpression("function"==typeof(r=null!=(r=e.fullURL||(null!=a?a.fullURL:a))?r:e.helperMissing)?r.call(null!=a?a:{},{name:"fullURL",hash:{},data:t}):r)+'" data-dynamic="true">'},15:function(n,a,e,l,t){var r,i=null!=a?a:{},o=e.helperMissing,p=n.escapeExpression;return'<meta property="og:image" content="'+p("function"==typeof(r=null!=(r=e.openGraphImageURL||(null!=a?a.openGraphImageURL:a))?r:o)?r.call(i,{name:"openGraphImageURL",hash:{},data:t}):r)+'" data-dynamic="true">\n<meta property="og:image:width" content="'+p("function"==typeof(r=null!=(r=e.openGraphaImageWidth||(null!=a?a.openGraphaImageWidth:a))?r:o)?r.call(i,{name:"openGraphaImageWidth",hash:{},data:t}):r)+'" data-dynamic="true">\n<meta property="og:image:height" content="'+p("function"==typeof(r=null!=(r=e.openGraphaImageHeight||(null!=a?a.openGraphaImageHeight:a))?r:o)?r.call(i,{name:"openGraphaImageHeight",hash:{},data:t}):r)+'" data-dynamic="true">\n'},17:function(n,a,e,l,t){return'<link rel="openid2.provider" href="https://open.login.yahooapis.com/openid/op/auth" data-dynamic="true"/>'},19:function(n,a,e,l,t){var r,i=null!=a?a:{},o=e.helperMissing,p=n.escapeExpression;return'<meta property="flickr_photos:'+p("function"==typeof(r=null!=(r=e.byPrefix||(null!=a?a.byPrefix:a))?r:o)?r.call(i,{name:"byPrefix",hash:{},data:t}):r)+'by" content="'+p("function"==typeof(r=null!=(r=e.domain||(null!=a?a.domain:a))?r:o)?r.call(i,{name:"domain",hash:{},data:t}):r)+p("function"==typeof(r=null!=(r=e.ownerURL||(null!=a?a.ownerURL:a))?r:o)?r.call(i,{name:"ownerURL",hash:{},data:t}):r)+'" data-dynamic="true">'},21:function(n,a,e,l,t){var r;return'<meta property="al:ios:url" content="flickr://flickr.com'+n.escapeExpression("function"==typeof(r=null!=(r=e.url||(null!=a?a.url:a))?r:e.helperMissing)?r.call(null!=a?a:{},{name:"url",hash:{},data:t}):r)+'" data-dynamic="true">'},23:function(n,a,e,l,t){var r;return'<meta property="twitter:card" content="'+n.escapeExpression("function"==typeof(r=null!=(r=e.twitterCardType||(null!=a?a.twitterCardType:a))?r:e.helperMissing)?r.call(null!=a?a:{},{name:"twitterCardType",hash:{},data:t}):r)+'" data-dynamic="true">'},25:function(n,a,e,l,t){return'<meta property="twitter:description" content="'+n.escapeExpression((e.stripTags||a&&a.stripTags||e.helperMissing).call(null!=a?a:{},null!=a?a.description:a,{name:"stripTags",hash:{},data:t}))+'" data-dynamic="true">'},27:function(n,a,e,l,t){var r;return'<meta property="twitter:app:url:iphone" content="flickr://flickr.com'+n.escapeExpression("function"==typeof(r=null!=(r=e.url||(null!=a?a.url:a))?r:e.helperMissing)?r.call(null!=a?a:{},{name:"url",hash:{},data:t}):r)+'" data-dynamic="true">'},29:function(n,a,e,l,t){var r,i=null!=a?a:{},o=e.helperMissing,p=n.escapeExpression;return'<meta property="'+p("function"==typeof(r=null!=(r=e.property||(null!=a?a.property:a))?r:o)?r.call(i,{name:"property",hash:{},data:t}):r)+'" content="https:'+p("function"==typeof(r=null!=(r=e.content||(null!=a?a.content:a))?r:o)?r.call(i,{name:"content",hash:{},data:t}):r)+'" data-dynamic="true">'},31:function(n,a,e,l,t){var r,i,o=null!=a?a:{};return'<link rel="alternate" type="application/atom+xml" '+(null!=(r=e.if.call(o,null!=a?a.title:a,{name:"if",hash:{},fn:n.program(32,t,0),inverse:n.noop,data:t}))?r:"")+' href="'+n.escapeExpression("function"==typeof(i=null!=(i=e.url||(null!=a?a.url:a))?i:e.helperMissing)?i.call(o,{name:"url",hash:{},data:t}):i)+'" data-dynamic="true">'},32:function(n,a,e,l,t){var r;return'title="'+n.escapeExpression("function"==typeof(r=null!=(r=e.title||(null!=a?a.title:a))?r:e.helperMissing)?r.call(null!=a?a:{},{name:"title",hash:{},data:t}):r)+'"'},compiler:[7,">= 4.0.0"],main:function(n,a,e,l,t){var r,i=null!=a?a:{};return(null!=(r=e.if.call(i,null!=a?a.title:a,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.description:a,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t}))?r:"")+"\n\n"+(null!=(r=e.if.call(i,null!=a?a.title:a,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.description:a,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.flickrType:a,{name:"if",hash:{},fn:n.program(9,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.ogType:a,{name:"if",hash:{},fn:n.program(11,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.fullURL:a,{name:"if",hash:{},fn:n.program(13,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.openGraphImageURL:a,{name:"if",hash:{},fn:n.program(15,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.openId:a,{name:"if",hash:{},fn:n.program(17,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.ownerURL:a,{name:"if",hash:{},fn:n.program(19,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.url:a,{name:"if",hash:{},fn:n.program(21,t,0),inverse:n.noop,data:t}))?r:"")+"\n\n"+(null!=(r=e.if.call(i,null!=a?a.twitterCardType:a,{name:"if",hash:{},fn:n.program(23,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.description:a,{name:"if",hash:{},fn:n.program(25,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.if.call(i,null!=a?a.url:a,{name:"if",hash:{},fn:n.program(27,t,0),inverse:n.noop,data:t}))?r:"")+"\n"+(null!=(r=e.each.call(i,null!=a?a.twitterImages:a,{name:"each",hash:{},fn:n.program(29,t,0),inverse:n.noop,data:t}))?r:"")+"\n\n"+(null!=(r=e.each.call(i,null!=a?a.feeds:a,{name:"each",hash:{},fn:n.program(31,t,0),inverse:n.noop,data:t}))?r:"")+"\n"},useData:!0}),l={};n.Array.each([],function(a){var e=n.Template.get("hermes/"+a);e&&(l[a]=e)}),n.Template.register("hermes/dynamic-page-head",function(a,t){return t=t||{},t.partials=t.partials?n.merge(l,t.partials):l,e(a,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-album-toolbar",function(a,t){var e=a.Template.Handlebars.revive({1:function(a,t,e,l,n){var s,i=null!=t?t:{},o=e.helperMissing,r=a.escapeExpression;return'\t\t<a class="edit-in-organizr" href="/photos/organize/?start_tab=one_set'+r("function"==typeof(s=null!=(s=e.setId||(null!=t?t.setId:t))?s:o)?s.call(i,{name:"setId",hash:{},data:n}):s)+'">'+r((e.intlMessage||t&&t.intlMessage||o).call(i,{name:"intlMessage",hash:{intlName:"album-page.EDIT_IN_ORGANIZR"},data:n}))+"</a>\n"},3:function(a,t,e,l,n){return" selected"},compiler:[7,">= 4.0.0"],main:function(a,t,e,l,n){var s,i,o=null!=t?t:{},r=e.helperMissing,u=a.escapeExpression;return'<div class="album-toolbar-content">\n\t<a class="back-to-albums" href="/photos/'+u("function"==typeof(i=null!=(i=e.nsidOrPathAlias||(null!=t?t.nsidOrPathAlias:t))?i:r)?i.call(o,{name:"nsidOrPathAlias",hash:{},data:n}):i)+"/albums/with/"+u("function"==typeof(i=null!=(i=e.setId||(null!=t?t.setId:t))?i:r)?i.call(o,{name:"setId",hash:{},data:n}):i)+'">\n\t\t<svg class="icon icon-back"><use xlink:href="#icon-back"></use></svg>\n\t\t<span class="back-to-albums-text">\n\t\t\t'+u((e.intlMessage||t&&t.intlMessage||r).call(o,{name:"intlMessage",hash:{intlName:"album-page.BACK_TO_ALBUMS"},data:n}))+"\n\t\t</span>\n\t</a>\n"+(null!=(s=e.if.call(o,null!=t?t.viewerIsOwner:t,{name:"if",hash:{},fn:a.program(1,n,0),inverse:a.noop,data:n}))?s:"")+"\t"+u((e.outlet||t&&t.outlet||r).call(o,null!=t?t["fluid-magic-slideshow-view"]:t,{name:"outlet",hash:{},data:n}))+'\n\t<button data-layout="justified" class="layout justified'+(null!=(s=e.if.call(o,null!=t?t.isJustifiedLayout:t,{name:"if",hash:{},fn:a.program(3,n,0),inverse:a.noop,data:n}))?s:"")+'" title="'+u((e.intlMessage||t&&t.intlMessage||r).call(o,{name:"intlMessage",hash:{intlName:"common.JUSTIFIED_VIEW"},data:n}))+'"></button>\n\t<button data-layout="story" class="layout story'+(null!=(s=e.if.call(o,null!=t?t.isStoryLayout:t,{name:"if",hash:{},fn:a.program(3,n,0),inverse:a.noop,data:n}))?s:"")+'" title="'+u((e.intlMessage||t&&t.intlMessage||r).call(o,{name:"intlMessage",hash:{intlName:"common.LARGE_VIEW"},data:n}))+'"></button>\n</div>\n'},useData:!0}),l={};a.Array.each([],function(t){var e=a.Template.get("hermes/"+t);e&&(l[t]=e)}),a.Template.register("hermes/album-toolbar",function(t,n){return n=n||{},n.partials=n.partials?a.merge(l,n.partials):l,e(t,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-fluid-magic-slideshow",function(e,a){var s=e.Template.Handlebars.revive({1:function(e,a,s,l,n){return" disabled"},compiler:[7,">= 4.0.0"],main:function(e,a,s,l,n){var i,r=null!=a?a:{};return'<a href="#" class="slideshow-toggle'+(null!=(i=s.unless.call(r,null!=a?a.isEnabled:a,{name:"unless",hash:{},fn:e.program(1,n,0),inverse:e.noop,data:n}))?i:"")+'" title="'+e.escapeExpression((s.intlMessage||a&&a.intlMessage||s.helperMissing).call(r,{name:"intlMessage",hash:{intlName:"common.TOGGLE_SLIDESHOW"},data:n}))+'" tabindex="-1"><span></span></a>\n'},useData:!0}),l={};e.Array.each([],function(a){var s=e.Template.get("hermes/"+a);s&&(l[a]=s)}),e.Template.register("hermes/fluid-magic-slideshow",function(a,n){return n=n||{},n.partials=n.partials?e.merge(l,n.partials):l,s(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-slideshow",function(a,n){var e=a.Template.Handlebars.revive({1:function(a,n,e,l,r){return" no-click"},3:function(a,n,e,l,r){return" is-hidden"},5:function(a,n,e,l,r){return" is-video"},7:function(a,n,e,l,r){var t;return a.escapeExpression("function"==typeof(t=null!=(t=e["prev-url"]||(null!=n?n["prev-url"]:n))?t:e.helperMissing)?t.call(null!=n?n:{},{name:"prev-url",hash:{},data:r}):t)},9:function(a,n,e,l,r){return"#"},11:function(a,n,e,l,r){var t;return a.escapeExpression("function"==typeof(t=null!=(t=e["next-url"]||(null!=n?n["next-url"]:n))?t:e.helperMissing)?t.call(null!=n?n:{},{name:"next-url",hash:{},data:r}):t)},compiler:[7,">= 4.0.0"],main:function(a,n,e,l,r){var t,s=null!=n?n:{},i=e.helperMissing,o=a.escapeExpression;return o((e.outlet||n&&n.outlet||i).call(s,null!=n?n["photo-well-view"]:n,{name:"outlet",hash:{},data:r}))+'\n<a class="playpause chrome" data-track="playpauseClick"><span class="pause-button"></span><span class="play-button"></span><div class="timer"></div></a>\n\n<a class="navigate-target chrome navigate-prev'+(null!=(t=e.if.call(s,null!=n?n["prev-is-not-clickable"]:n,{name:"if",hash:{},fn:a.program(1,r,0),inverse:a.noop,data:r}))?t:"")+(null!=(t=e.if.call(s,null!=n?n["is-hidden"]:n,{name:"if",hash:{},fn:a.program(3,r,0),inverse:a.noop,data:r}))?t:"")+(null!=(t=e.if.call(s,null!=n?n["is-video"]:n,{name:"if",hash:{},fn:a.program(5,r,0),inverse:a.noop,data:r}))?t:"")+'" href="'+(null!=(t=e.if.call(s,null!=n?n["prev-url"]:n,{name:"if",hash:{},fn:a.program(7,r,0),inverse:a.program(9,r,0),data:r}))?t:"")+'" data-track="prevPhotoButtonClick" data-direction="prev"><span class="navigate-target-arrow"></span></a>\n\n<a class="navigate-target chrome navigate-next'+(null!=(t=e.if.call(s,null!=n?n["next-is-not-clickable"]:n,{name:"if",hash:{},fn:a.program(1,r,0),inverse:a.noop,data:r}))?t:"")+(null!=(t=e.if.call(s,null!=n?n["is-hidden"]:n,{name:"if",hash:{},fn:a.program(3,r,0),inverse:a.noop,data:r}))?t:"")+(null!=(t=e.if.call(s,null!=n?n["is-video"]:n,{name:"if",hash:{},fn:a.program(5,r,0),inverse:a.noop,data:r}))?t:"")+'" href="'+(null!=(t=e.if.call(s,null!=n?n["next-url"]:n,{name:"if",hash:{},fn:a.program(11,r,0),inverse:a.program(9,r,0),data:r}))?t:"")+'" data-track="nextPhotoButtonClick" data-direction="next"><span class="navigate-target-arrow"></span></a>\n\n<a class="close chrome" data-track="closeClick"><span></span></a>\n'+o((e.outlet||n&&n.outlet||i).call(s,null!=n?n["slideshow-attribution-view"]:n,{name:"outlet",hash:{},data:r}))+"\n"},useData:!0}),l={};a.Array.each([],function(n){var e=a.Template.get("hermes/"+n);e&&(l[n]=e)}),a.Template.register("hermes/slideshow",function(n,r){return r=r||{},r.partials=r.partials?a.merge(l,r.partials):l,e(n,r)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-attribution",function(a,n){var e=a.Template.Handlebars.revive({1:function(a,n,e,l,t){var i,s=null!=n?n:{},r=e.helperMissing,o=a.escapeExpression;return'\t<a class="avatar person medium no-menu" data-person-nsid="'+o("function"==typeof(i=null!=(i=e.nsid||(null!=n?n.nsid:n))?i:r)?i.call(s,{name:"nsid",hash:{},data:t}):i)+'" style="background-image: url('+o("function"==typeof(i=null!=(i=e.buddyicon||(null!=n?n.buddyicon:n))?i:r)?i.call(s,{name:"buddyicon",hash:{},data:t}):i)+');" href="/photos/'+o("function"==typeof(i=null!=(i=e.pathAlias||(null!=n?n.pathAlias:n))?i:r)?i.call(s,{name:"pathAlias",hash:{},data:t}):i)+'/"></a>\n'},3:function(a,n,e,l,t){var i,s=null!=n?n:{},r=e.helperMissing,o=a.escapeExpression;return'\t<div class="avatar person medium" data-person-nsid="'+o("function"==typeof(i=null!=(i=e.nsid||(null!=n?n.nsid:n))?i:r)?i.call(s,{name:"nsid",hash:{},data:t}):i)+'" style="background-image: url('+o("function"==typeof(i=null!=(i=e.buddyicon||(null!=n?n.buddyicon:n))?i:r)?i.call(s,{name:"buddyicon",hash:{},data:t}):i)+');" tabindex="0"></div>\n'},5:function(a,n,e,l,t){var i;return null!=(i=e.if.call(null!=n?n:{},null!=n?n.isPro:n,{name:"if",hash:{},fn:a.program(6,t,0),inverse:a.noop,data:t}))?i:""},6:function(a,n,e,l,t){var i;return null!=(i=a.invokePartial(l["pro-badge"],n,{name:"pro-badge",data:t,indent:"\t\t",helpers:e,partials:l,decorators:a.decorators}))?i:""},8:function(a,n,e,l,t){var i;return null!=(i=e.if.call(null!=n?n:{},null!=n?n.isPro:n,{name:"if",hash:{},fn:a.program(9,t,0),inverse:a.noop,data:t}))?i:""},9:function(a,n,e,l,t){var i;return null!=(i=a.invokePartial(l["pro-badge"],n,{name:"pro-badge",data:t,indent:"\t\t\t",helpers:e,partials:l,decorators:a.decorators}))?i:""},compiler:[7,">= 4.0.0"],main:function(a,n,e,l,t){var i,s,r=null!=n?n:{},o=e.helperMissing,u=a.escapeExpression;return(null!=(i=e.if.call(r,null!=n?n.noMenu:n,{name:"if",hash:{},fn:a.program(1,t,0),inverse:a.program(3,t,0),data:t}))?i:"")+"\n"+(null!=(i=e.unless.call(r,null!=n?n.isAlbumView:n,{name:"unless",hash:{},fn:a.program(5,t,0),inverse:a.noop,data:t}))?i:"")+'\n<div class="attribution-info">\n\n\t<a href="/photos/'+u("function"==typeof(s=null!=(s=e.pathAlias||(null!=n?n.pathAlias:n))?s:o)?s.call(r,{name:"pathAlias",hash:{},data:t}):s)+'/" class="owner-name truncate" title="'+u((e.intlMessage||n&&n.intlMessage||o).call(r,{name:"intlMessage",hash:{name:null!=n?n.displayname:n,intlName:"attribution.GO_TO_PHOTOSTREAM"},data:t}))+'" data-track="attributionNameClick">'+u("function"==typeof(s=null!=(s=e.displayname||(null!=n?n.displayname:n))?s:o)?s.call(r,{name:"displayname",hash:{},data:t}):s)+'</a>\n\t<a href="/photos/'+u("function"==typeof(s=null!=(s=e.pathAlias||(null!=n?n.pathAlias:n))?s:o)?s.call(r,{name:"pathAlias",hash:{},data:t}):s)+'/" class="owner-name-with-by truncate" title="'+u((e.intlMessage||n&&n.intlMessage||o).call(r,{name:"intlMessage",hash:{name:null!=n?n.displayname:n,intlName:"attribution.GO_TO_PHOTOSTREAM"},data:t}))+'" data-track="attributionNameClick">'+u((e.intlMessage||n&&n.intlMessage||o).call(r,{name:"intlMessage",hash:{user:null!=n?n.displayname:n,intlName:"attribution.BY_USER"},data:t}))+"</a>\n\n\t"+u((e.outlet||n&&n.outlet||o).call(r,null!=n?n["follow-view"]:n,{name:"outlet",hash:{},data:t}))+"\n\n"+(null!=(i=e.if.call(r,null!=n?n.isAlbumView:n,{name:"if",hash:{},fn:a.program(8,t,0),inverse:a.noop,data:t}))?i:"")+"\n</div>\n"},usePartial:!0,useData:!0}),l={};a.Array.each(["pro-badge","pro-badge"],function(n){var e=a.Template.get("hermes/"+n);e&&(l[n]=e)}),a.Template.register("hermes/attribution",function(n,t){return t=t||{},t.partials=t.partials?a.merge(l,t.partials):l,e(n,t)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-pro-badge","hermes-template-pro-badge"]});YUI.add("slideshow-attribution-view",function(e,i){var n=require("hermes-core/flog")(i);e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(e){this.set("isActiveViewAgnostic",e.isActiveViewAgnostic);var i=e.collection.getList()[e.position];return i&&(this.nsid=e.nsid=i.getValue("owner").getValue("nsid")),this.realFullscreen=!0,this},langBundles:this.details.langBundles,subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,isActiveViewAgnostic:!0,isFluid:!0,isOnDark:!0}},loadState:function(){var e=this;if(this.nsid)return this.appContext.getModel("person-models",this.nsid).then(function(i){e.set("owner",i)});throw new Error("missing nsid")},buildContainer:function(){var e,i=this.get("owner"),n=this.appContext.getViewer().nsid,t=i.getValue("pathAlias")||i.getValue("nsid");return e=i.getValue("buddyicon").large?i.getValue("buddyicon").large:i.getValue("buddyicon").default,this.setContainerWithTemplate("attribution",{pathAlias:t,buddyicon:e,nsid:i.getValue("nsid"),noMenu:!0,displayname:i.getValue("displayname"),follow:this.subviews["follow-view"]?this.subviews["follow-view"].get("container"):"",realFullscreenEnabled:this.realFullscreen&&this.appContext.experiments.fullscreen.getMode()}),n===i.getValue("nsid")&&this.get("container").addClass("is-self"),this},activate:function(){return this.registerEventHandler(e.on("personMenuOpen",this.handlePersonMenuOpen.bind(this))),this.registerEventHandler(e.on("personMenuClose",this.handlePersonMenuClose.bind(this))),this},handlePersonMenuOpen:function(e){this.fire("subviewViewEvent","personMenuOpen")},handlePersonMenuClose:function(e){this.fire("subviewViewEvent","personMenuClose")},onParentViewEvent:function(e,i){var t,s,o=this;i&&i[0]&&("slideshowView:newPhoto"===(t=i[0])?i[1]&&(s=i[1].getValue("owner").getValue("nsid"))!==this.nsid&&(this.nsid=s,this.set("owner",i[1].getValue("owner")),this.subviews["follow-view"]&&this.subviews["follow-view"].destroy({remove:!0}),this.instantiateSubview("follow-view",{nsid:s,realFullscreen:!0,isActiveViewAgnostic:!0,isFluid:!0,isOnDark:!0}).then(function(e){return e.initialize()}).then(function(e){o.buildContainer(),o.get("container").one(".follow-view").addClass("is-real-fullscreen photo-attribution"),e.normalizedActivate()}).catch(function(e){n.error("Error loading follow-view",{err:e})})):"slideshowView:preloadPhoto"===t&&(s=i[1].getValue("owner").getValue("nsid"))!==this.nsid&&o.appContext.getModel("person-relationship-models",{id:s}))}})},"@VERSION@",{requires:["flickr-view","hermes-template-attribution"],optional:["person-models"],langBundles:["attribution"]});YUI.add("hermes-lang-attribution",function(e,r){e.Intl.add("hermes/attribution","en-US",{FOLLOW:["Follow"],FOLLOWING:["Following"],ERROR_SETTING_FRIEND:["There was a problem setting your friend relationship"],ERROR_SETTING_FAMILY:["There was a ",{type:"number",valueName:"POPULATION",format:"integer"}," problem setting your family relationship"],FRIEND:["Friend"],FAMILY:["Family"],UNFOLLOW:["Unfollow"],GO_TO_PHOTOSTREAM:["Go to ","${name}","'s photostream"],BY_USER:["By: ","${user}"]})},"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-photo-well-media-scrappy",function(t,a){var e=t.Template.Handlebars.revive({1:function(t,a,e,l,n){var i,s=null!=a?a:{};return'\t<div class="restricted-interstitial">\n\t\t<div class="restricted-interstitial-message">\n\t\t\t<h2>'+t.escapeExpression((e.intlMessage||a&&a.intlMessage||e.helperMissing).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADULT_CONTENT"},data:n}))+"</h2>\n"+(null!=(i=e.if.call(s,null!=a?a.isSignedIn:a,{name:"if",hash:{},fn:t.program(2,n,0),inverse:t.program(5,n,0),data:n}))?i:"")+"\t\t</div>\n\t</div>\n"},2:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return"\t\t\t\t<p>"+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.MATURE_AUDIENCES"},data:n}))+"<br />"+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.USER_DISCRETION"},data:n}))+"</p>\n\n"+(null!=(i=e.unless.call(s,null!=a?a.isMinor:a,{name:"unless",hash:{},fn:t.program(3,n,0),inverse:t.noop,data:n}))?i:"")},3:function(t,a,e,l,n){var i=null!=a?a:{},s=e.helperMissing,h=t.escapeExpression;return"\t\t\t\t\t<p><button class='ui-button'><span>"+h((e.intlMessage||a&&a.intlMessage||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_ME_THIS_CONTENT_TYPE"},data:n}))+"</span></button></p>\n\t\t\t\t\t<p>"+h((e.intlHTMLMessage||a&&a.intlHTMLMessage||s).call(i,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.CHANGE_SAFE_SEARCH_IN_SETTINGS"},data:n}))+"</p>\n"},5:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return"\t\t\t\t<p>"+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SIGNED_IN_FOR_CONTENT"},data:n}))+' <a href="//'+r("function"==typeof(i=null!=(i=e.host||(null!=a?a.host:a))?i:h)?i.call(s,{name:"host",hash:{},data:n}):i)+'/signin/" data-track="photoWellSignInClick">'+r((e.intlMessage||a&&a.intlMessage||h).call(s,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:n}))+"</a></p>\n"},7:function(t,a,e,l,n){var i;return null!=(i=e.if.call(null!=a?a:{},null!=a?a.isVideo:a,{name:"if",hash:{},fn:t.program(8,n,0),inverse:t.program(10,n,0),data:n}))?i:""},8:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return'\t\t<div class="videoplayer main-photo" style="width:'+r("function"==typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)?i.call(s,{name:"width",hash:{},data:n}):i)+"px; height:"+r("function"==typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)?i.call(s,{name:"height",hash:{},data:n}):i)+'px;"><video id="video_1" poster="'+r("function"==typeof(i=null!=(i=e.src||(null!=a?a.src:a))?i:h)?i.call(s,{name:"src",hash:{},data:n}):i)+'" class="video-js vjs-big-play-centered inherit-size"></video></div>\n'},10:function(t,a,e,l,n){var i;return"\n"+(null!=(i=e.if.call(null!=a?a:{},null!=a?a.showFuzzy:a,{name:"if",hash:{},fn:t.program(11,n,0),inverse:t.program(13,n,0),data:n}))?i:"")},11:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r=t.escapeExpression;return'\t\t<span class="restricted-image main-photo" style="width:'+r("function"==typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)?i.call(s,{name:"width",hash:{},data:n}):i)+"px;height:"+r("function"==typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)?i.call(s,{name:"height",hash:{},data:n}):i)+'px;">\n\t\t</span>\n'},13:function(t,a,e,l,n){var i,s=null!=a?a:{},h=e.helperMissing,r="function",o=t.escapeExpression;return'\t\t<span class="facade-of-protection-neue" style="width:'+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+"px;height:"+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'px;">\n\t\t\t'+o((e.outlet||a&&a.outlet||h).call(s,null!=a?a["zoom-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\t\t\t"+o((e.outlet||a&&a.outlet||h).call(s,null!=a?a["vr-overlay-view"]:a,{name:"outlet",hash:{},data:n}))+'\n\t\t</span>\n\n\t\t<img width="'+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+'" height="'+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'" src="'+o(typeof(i=null!=(i=e.src||(null!=a?a.src:a))?i:h)===r?i.call(s,{name:"src",hash:{},data:n}):i)+'" class="low-res-photo" alt="'+o(typeof(i=null!=(i=e.imgAltText||(null!=a?a.imgAltText:a))?i:h)===r?i.call(s,{name:"imgAltText",hash:{},data:n}):i)+'">\n\t\t<img width="'+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+'" height="'+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'" src="'+o(typeof(i=null!=(i=e.highResSrc||(null!=a?a.highResSrc:a))?i:h)===r?i.call(s,{name:"highResSrc",hash:{},data:n}):i)+'" class="main-photo is-hidden" alt="'+o(typeof(i=null!=(i=e.imgAltText||(null!=a?a.imgAltText:a))?i:h)===r?i.call(s,{name:"imgAltText",hash:{},data:n}):i)+'">\n\t\t<script nonce="'+o(typeof(i=null!=(i=e.cspNonce||(null!=a?a.cspNonce:a))?i:h)===r?i.call(s,{name:"cspNonce",hash:{},data:n}):i)+"\">\n\t\tvar img = document.querySelector('.photo-well-media-scrappy-view img.main-photo');\n\t\timg.onload = function () { registerFirstPhoto(img); };\n\t\t<\/script>\n\t\t<noscript>\n\t\t\t<img width=\""+o(typeof(i=null!=(i=e.width||(null!=a?a.width:a))?i:h)===r?i.call(s,{name:"width",hash:{},data:n}):i)+'" height="'+o(typeof(i=null!=(i=e.height||(null!=a?a.height:a))?i:h)===r?i.call(s,{name:"height",hash:{},data:n}):i)+'" src="'+o(typeof(i=null!=(i=e.highResSrc||(null!=a?a.highResSrc:a))?i:h)===r?i.call(s,{name:"highResSrc",hash:{},data:n}):i)+'" class="main-photo" alt="'+o(typeof(i=null!=(i=e.imgAltText||(null!=a?a.imgAltText:a))?i:h)===r?i.call(s,{name:"imgAltText",hash:{},data:n}):i)+'">\n\t\t</noscript>\n'},compiler:[7,">= 4.0.0"],main:function(t,a,e,l,n){var i;return null!=(i=e.if.call(null!=a?a:{},null!=a?a.needsInterstitial:a,{name:"if",hash:{},fn:t.program(1,n,0),inverse:t.program(7,n,0),data:n}))?i:""},useData:!0}),l={};t.Array.each([],function(a){var e=t.Template.get("hermes/"+a);e&&(l[a]=e)}),t.Template.register("hermes/photo-well-media-scrappy",function(a,n){return n=n||{},n.partials=n.partials?t.merge(l,n.partials):l,e(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("slideshow-well-view",function(e,t){var i=require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){var t=e.collection.getList()[e.position];if(!t)throw new Error("missing photo");return this.set("photo",t),this.set("isActiveViewAgnostic",!0),this.set("canvasSizeIsDirty",!0),""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},buildContainer:function(){var e,t,o=this,n=this.get("photo");return o.preloadImage&&(o.preloadImage.onload=null),this.appContext.forceServerRender?t=e=this.getPhotoForDisplay(n,{canvas:{width:Number.MAX_VALUE,height:Number.MAX_VALUE}}):(e=this.getPhotoForDisplay(n),t=this.getPhotoForDisplay(n,{includeSizes:["sq","q","t","s","n"]})),this.setContainerWithTemplate("photo-well-media-scrappy",{width:e.width,height:e.height,src:t.url,highResSrc:e.url,showFuzzy:n.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isVideo:!1}),YUI.Env.isServer?(this.serverWidth=e.width,this.serverHeight=e.height):n.getValue("needsInterstitial")||this.preloadPhoto(n).then(function(){var e=o.get("container").one(".low-res-photo"),t=o.get("container").one(".main-photo");t&&t.removeClass("is-hidden").show(),e&&e.hide()}).catch(function(e){i.error("Error building slideshow",{err:e})}),this},preloadPhoto:function(t){var i=this;return new e.Promise(function(e,o){return i.generatePhotoElement(t,e,o)})},generateFuzzyElement:function(e){var t,i;return t=this.getPhotoForDisplay(e),i=document.createElement("span"),i.style.width=t.width+"px",i.style.height=t.height+"px",i},generatePhotoElement:function(t,i,o){var n,r;return n=this.getPhotoForDisplay(t),r=new Image,r.src=n.url,r.width=n.width,r.height=n.height,r.complete&&i&&"function"==typeof i&&i(t),r=e.one(r),i&&"function"==typeof i&&r.once("load",function(){i(t),r.detachAll(),r=void 0}),o&&"function"==typeof o&&r.once("error",function(){o(t),r.detachAll(),r=void 0}),r},handlePhotoLoaded:function(e){this.fire("subviewViewEvent","photoLoaded"),e.getValue("isOwner")||this.appContext.getViewCounter().queue(e.getValue("id"),this.appContext.getReferrer())},swapPhoto:function(t,i){var o,n,r;(r=this.get("container").one(".restricted-image"))&&(n=!0),t.getValue("needsInterstitial")?((o=this.generateFuzzyElement(t)).className="main-photo outro restricted-image",o=e.one(o),r=this.get("container").one(".main-photo"),i||(r.once("transitionend",function(){r.detach(),r&&r.remove(!0),r=void 0}),r.removeClass("main-photo"),r.removeClass("intro"),r.addClass("outro"),o.removeClass("outro"),o.addClass("intro")),r.insert(o,"before"),i&&(o.removeClass("outro"),r.remove(!0)),this.fire("subviewViewEvent","photoLoaded")):(o=this.generatePhotoElement(t,this.handlePhotoLoaded.bind(this)),n||(r=this.get("container").one(".main-photo")),o.addClass("main-photo"),o.addClass("outro"),r&&r.removeClass("main-photo"),i?(o&&o.removeClass("outro"),r&&(r.insert(o,"before"),r.remove(!0))):(r&&(r.once("transitionend",function(){r.detachAll(),r&&r.remove(!0),r=void 0}),r.addClass("outro"),r.removeClass("intro"),r.insert(o,"before")),o&&(o.removeClass("outro"),o.addClass("intro"))))},onParentViewEvent:function(e,t){if(t&&t[0])switch(t[0]){case"photoWellResized":this.get("photo").getValue("needsInterstitial")||this.buildContainer();break;case"slideshowView:newPhoto":t[1]&&(this.set("photo",t[1]),this.swapPhoto(t[1],t[2]));break;case"slideshowView:preloadPhoto":t[1]&&this.preloadPhoto(t[1])}},activate:function(){var t=this;return this.get("photo").getValue("needsInterstitial")||(this.registerEventHandler(e.on("flickr:photo-media-well-update",function(e){t.buildContainer()})),e.use("global-events",function(e){t.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){t.buildContainer()}))})),this.appContext.getViewer().signedIn&&this.appContext.getModel("person-preferences-models",t.appContext.auth.user.nsid).then(function(e){t.set("personPreferences",e),t.get("photo").getValue("needsInterstitial")&&!this.appContext.getViewer().isMinor&&t.registerEventHandler(t.get("container").one(".restricted-interstitial-message button").on("click",t.handleInterstitialDismissButtonClick,t))}),this},getPhotoForDisplay:function(e,t){var i,o,n,r=this.getCanvasSize(),s=this.getPixelRatio();return t&&t.canvasSize&&(r=t.canvasSize),i=e.getSizeToFit(r,t),o=r.height/s,n=Math.min(r.width/s,i.width/i.height*o),o=Math.min(o,i.height/i.width*n),{width:Math.round(n),height:Math.round(o),url:i.url,pixelRatio:i.width/n}},getCanvasSize:function(){var t,i,o=this.getPixelRatio(),n={width:500,height:500};return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(i=e.one("#content"))&&((t=i.get("region")).height=e.config.win.innerHeight,t.width=e.config.win.innerWidth):t=this.get("cachedCanvasSize"),this.appContext.viewportData.viewport.width>0&&(n={width:this.appContext.viewportData.viewport.width,height:this.appContext.viewportData.viewport.height-240}),t||(t={top:0,left:0,bottom:500,right:500,width:n.width,height:n.height}),t.height*=o,t.width*=o,t},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-well-media-scrappy"],langBundles:["common","photo-page-scrappy"]});YUI.add("slideshow-view",function(e,t){var i=require("hermes-core/flog")(t);e.namespace("Views").Slideshow=e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){if(this.set("isActiveViewAgnostic",!0),this.collection=e.collection,this.pageParams=e.pageParams||{perPage:20},this.pageParams.page=parseInt(e.pageNumber,10)||1,this.position=parseInt(e.position,10)||0,this.collection.totalItems<1)throw new Error("no items in collection");return""===this.get("container").getHTML()&&this.setContainerWithTemplate("flickr-balls"),this},subviewConfig:{"slideshow-attribution-view":{isActiveViewAgnostic:!0,requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["is-real-fullscreen","photo-attribution","chrome"]},"slideshow-well-view":{isActiveViewAgnostic:!0,requiredToShowOnClient:!1,requiredToShowOnServer:!1,dealbreaker:!0}},loadState:function(){var e=this;return this.collection.getPage(this.pageParams).then(function(){var t,s,n,a=e.collection.getList();if(!a[e.position])throw new Error("The starting photo does not exist.");if(t=parseInt(e.collection.totalItems,10),e.bufferPhotos(e.position,e.get("bufferSize")),s=t-1,(n=e.position-1)<0&&(n=s),!a[n])return e.pageParams.page=Math.ceil(n/e.pageParams.perPage),e.collection.getPage(e.pageParams).then(function(){e.bufferPhotos(e.position,e.get("bufferSize"),"prev")}).catch(function(e){i.error("Error fetching next page in collection",{err:e})})}).catch(function(t){i.error("Error initializing slideshow",{err:t}),e.close()})},buildContainer:function(){var e;return this.subviews["slideshow-attribution-view"]&&(e=this.subviews["slideshow-attribution-view"].get("container")),this.setContainerWithTemplate("slideshow",{"slideshow-attribution-view":e,"photo-well-view":this.subviews["slideshow-well-view"].get("container")}),this},freeze:function(){e.one("body").setStyles({overflow:"hidden"})},unfreeze:function(){e.one("body").setStyles({overflow:"visible"})},show:function(){var t=this,s=e.one("#content");return e.use("d3",function(){if(s){s.append(t.get("container")),t.get("enableFullscreen")&&(t.fullScreenManager=new e.fluid.Fullscreen,t.fullScreenManager.on("enterFullscreen",t.finishInitialization.bind(t)),t.fullScreenManager.enterFullscreen());try{t.initialize().then(function(){t.finishInitialization()}).catch(function(e){i.error("Error initializing slideshow",{err:e}),t.close()})}catch(e){i.error("Error initializing slideshow",{err:e}),t.close()}e.fire("flickr:setKeyEventScope",t.getKeyEventScope()),t.freeze()}else i.error("Error initializing slideshow: missing content div")}),this},close:function(t){var i=this.get("container");e.fire("flickr:removeKeyEventScope",this.getKeyEventScope()),this.get("enableFullscreen")&&(this.fullScreenManager.exitFullscreen(),this.fullScreenManager.destroy()),i&&i.remove(!0),this.unfreeze(),this.fire("close",t),clearTimeout(this.mouseMoveTimer),clearTimeout(this.initialFadeTimer),clearTimeout(this.timer),clearTimeout(this.movingFadeTimer),this.destroy({remove:!0})},removeCircleTimer:function(){var t=e.d3.select(".timer > svg");t=t.remove()},drawCircleTimer:function(){var t,i,s,n={},a=this.get("autoplayInterval"),o=this.get("container").one(".timer");n.width=o.get("clientWidth"),n.height=o.get("clientHeight"),t=e.d3.svg.arc().innerRadius(35).outerRadius(40),i=e.d3.scale.linear().range([0,360]).domain([0,360]),s=e.d3.range(i(360)).map(function(e,t){return t*=2,{startAngle:t*(Math.PI/360),endAngle:(t+2)*(Math.PI/360)}}),e.d3.select(".timer").append("svg").attr("class","arc-timer").attr("width",n.width).attr("height",n.height).append("g").attr("transform","translate("+n.width/2+", "+n.height/2+")").append("g").selectAll("path").data(s).enter().append("path").attr("fill",function(e){return"#fff"}).transition().delay(function(e,t){return t*a/s.length}).duration(a/s.length).ease("linear").attrTween("d",function(i){var s=e.d3.interpolate(i.startAngle,i.endAngle);return function(e){return i.endAngle=s(e),t(i)}})},getNextSafePhoto:function(e,t){var i,s;if(i=this.collection.getList(),s=parseInt(this.collection.totalItems,10),"next"===(t=t||"next")){if((e+=1)===s){if(!this.collection.fetchedEnd)return;e=0}}else if(-1==(e-=1)){if(!this.collection.fetchedEnd)return;e=s-1}return i[e]?e:e===this.position?-1:this.getNextSafePhoto(e,t)},handlePhotoChange:function(e,t){var s,n,a,o,r;s=this.collection.getList(),a=parseInt(this.collection.totalItems,10)-1,e=e||"next",(o=this.getNextSafePhoto(this.position,e))>-1&&(this.position=o),"next"===e?(n=this.position+this.pageParams.perPage)>a&&(n-=a):(n=this.position-this.pageParams.perPage)<0&&(n=a),r=s[this.position],this.fire("parentViewEvent","slideshowView:newPhoto",r,t),s[n]||(this.pageParams.page=Math.ceil(n/this.pageParams.perPage),this.collection.getPage(this.pageParams).catch(function(e){i.error("Error fetching next page in collection",{err:e})})),this.bufferPhotos(this.position,this.get("bufferSize"),e)},bufferPhotos:function(e,t,i){var s,n,a;if(a=this.collection.getList(),n=parseInt(this.collection.totalItems,10),i=i||"next",t>0&&("next"===i?(e+=1)===n&&(e=0):(e-=1)<0&&(e=n-1),s=a[e]))return this.fire("parentViewEvent","slideshowView:preloadPhoto",s),t-=1,this.bufferPhotos(e,t,i)},handleKeys:function(t){var i=t.button;37===i||74===i?(e.rapidTracker.beacon(this.name,"keyboardLeft"),t.halt(),this.handleNavigation("prev",!0)):39===i||75===i||13===i?(e.rapidTracker.beacon(this.name,"keyboardRight"),t.halt(),this.handleNavigation("next",!0)):32===i?(e.rapidTracker.beacon(this.name,"keyboardPause"),t.halt(),this.handlePlayPause(this.get("container").one(".playpause"))):27===i?(e.rapidTracker.beacon(this.name,"keyboardEsc"),t.halt(),this.close()):t.halt()},handleNavigation:function(e,t){this.handlePhotoChange(e,t),clearTimeout(this.movingFadeTimer),this.movingFadeTimer=setTimeout(this.handleMouseIdle.bind(this),this.get("fadeTimer"))},handlePlayPause:function(e){this.showChrome(),this.toggleAutoplay()},handleClick:function(t){var i,s=t.target;s.hasClass("navigate-target")?(e.rapidTracker.beacon(this.name,"mouseNav"),t.halt(),i=s.getData("direction"),this.handleNavigation(i,!0)):s.hasClass("playpause")?(e.rapidTracker.beacon(this.name,"mousePlayPause"),t.halt(),this.handlePlayPause(s)):s.hasClass("close")&&(e.rapidTracker.beacon(this.name,"mouseClose"),t.halt(),this.close())},getKeyEventScope:function(){return this.name+this._yuid},cycle:function(){clearTimeout(this.timer),this.removeCircleTimer(),this.timer=setTimeout(this.handlePhotoChange.bind(this),this.get("autoplayInterval")),this.drawCircleTimer()},pauseAutoplay:function(){var t=this.get("container").one(".playpause");e.rapidTracker.beacon(this.name,"pauseAutoplay"),clearTimeout(this.timer),this.isPlaying=!1,this.removeCircleTimer(),t.removeClass("playing"),t.addClass("paused")},startAutoplay:function(){var t=this.get("container").one(".playpause");e.rapidTracker.beacon(this.name,"startAutoplay"),this.isPlaying=!0,this.cycle(),t.removeClass("paused"),t.addClass("playing")},toggleAutoplay:function(){this.isPlaying?this.pauseAutoplay():this.startAutoplay()},showChrome:function(){clearTimeout(this.movingFadeTimer),this.isShowingChrome=!0,this.movingFadeTimer=setTimeout(this.handleMouseIdle.bind(this),this.get("fadeTimer")),this.get("container").removeClass("idle")},handleMouseMove:function(e){if(this.isShowingChrome)return this.startPoint={x:e.pageX,y:e.pageY},clearTimeout(this.movingFadeTimer),void(this.movingFadeTimer=setTimeout(this.handleMouseIdle.bind(this),this.get("fadeTimer")));this.startPoint?(clearTimeout(this.mouseMoveTimer),clearTimeout(this.initialFadeTimer),Math.round(Math.sqrt(Math.pow(this.startPoint.y-e.pageY,2)+Math.pow(this.startPoint.x-e.pageX,2)))>this.get("chromeTriggerRadius")&&this.showChrome(),this.mouseMoveTimer=setTimeout(this.resetMouseDistance.bind(this),this.get("mouseIdleTimer"))):this.startPoint={x:e.pageX,y:e.pageY}},resetMouseDistance:function(){this.startPoint=null},handleMouseIdle:function(){var t;this.startPoint&&(t=e.one(document.elementFromPoint(this.startPoint.x,this.startPoint.y)))&&t.ancestor(function(e){return e.hasClass("chrome")},!0)?this.movingFadeTimer=setTimeout(this.handleMouseIdle.bind(this),this.get("fadeTimer")):this.hideChrome()},hideChrome:function(){this.resetMouseDistance(),this.get("container").addClass("idle"),this.isShowingChrome=!1,clearTimeout(this.movingFadeTimer)},onSubviewEvent:function(e,t){"slideshow-well-view"===e&&"photoLoaded"===t[0]?this.isPlaying&&this.cycle():"slideshow-attribution-view"!==e||"isOpen"!==t[0]&&"personMenuOpen"!==t[0]?"slideshow-attribution-view"!==e||"isClosed"!==t[0]&&"personMenuClose"!==t[0]||(this.movingFadeTimer=setTimeout(this.handleMouseIdle.bind(this),this.get("fadeTimer"))):(clearTimeout(this.movingFadeTimer),clearTimeout(this.initialFadeTimer),this.pauseAutoplay())},finishInitialization:function(){!this.finished&&this.get("enableFullscreen")&&this.fullScreenManager.isInFullscreenMode()?this.finished=!0:(this.get("autoplay")&&this.startAutoplay(),this.initialFadeTimer=setTimeout(this.hideChrome.bind(this),1500))},activate:function(){var t=this.get("container");return this.registerEventHandler(t.on("click",this.handleClick,this)),this.registerEventHandler(this.appContext.flapp.before("activeViewChange",this.close.bind(this))),this._params&&(this._params.keyEventScope=this.getKeyEventScope()),this.attachKeyEvent("down:8,13,27,32,37,74,39,75",e.betterThrottle(this.handleKeys.bind(this),100)),this.get("enableFullscreen")&&this.registerEventHandler(this.fullScreenManager.on("exitFullscreen",this.close.bind(this))),this.registerEventHandler(e.one("body").on("mousemove",e.betterThrottle(this.handleMouseMove.bind(this)))),this}},{ATTRS:{autoplay:{value:!0},autoplayInterval:{value:5e3},fadeTimer:{value:2e3},mouseIdleTimer:{value:200},chromeTriggerRadius:{value:30},bufferSize:{value:2},enableFullscreen:{value:!0}}})},"@VERSION@",{requires:["flickr-view","hermes-template-slideshow","slideshow-attribution-view","slideshow-well-view"],optionalRequires:["fluid-fullscreen"],langBundles:["common","photo-page-scrappy"]});YUI.add("fluid-fullscreen",function(e){"use strict";function n(){var n=e.config.doc;return n.fullscreenEnabled||n.webkitFullscreenEnabled||n.mozFullScreenEnabled||n.msFullscreenEnabled}function l(){var n=e.config.doc;return n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement}e.mix(e.Node.DOM_EVENTS,{fullscreenchange:!0,webkitfullscreenchange:!0,mozfullscreenchange:!0,MSFullscreenChange:!0}),e.namespace("fluid").Fullscreen=function(){this.fullscreenChangeHandler=e.on("fullscreenchange",this.handleFullscreenChange.bind(this)),this.webkitFullscreenChangeHandler=e.on("webkitfullscreenchange",this.handleFullscreenChange.bind(this)),this.mozFullscreenChangeHandler=e.on("mozfullscreenchange",this.handleFullscreenChange.bind(this)),this.msFullscreenChangeHandler=e.on("MSFullscreenChange",this.handleFullscreenChange.bind(this)),this.publish("enterFullscreen"),this.publish("exitFullscreen")},e.fluid.Fullscreen.prototype={isFullscreenCapable:n,isInFullscreenMode:l,enterFullscreen:function(l){var r=e.config.doc.documentElement;if(l&&(r=l.getDOMNode()),n()){if(r.requestFullscreen)return r.requestFullscreen();if(r.webkitRequestFullscreen)return r.webkitRequestFullscreen();if(r.mozRequestFullScreen)return r.mozRequestFullScreen();if(r.msRequestFullscreen)return r.msRequestFullscreen()}return!1},exitFullscreen:function(){var n=e.config.doc;if(l()){if(n.exitFullscreen)return n.exitFullscreen();if(n.webkitExitFullscreen)return n.webkitExitFullscreen();if(n.mozCancelFullScreen)return n.mozCancelFullScreen();if(n.msExitFullscreen)return n.msExitFullscreen()}return!1},handleFullscreenChange:function(){this.isInFullscreenMode()?this.fire("enterFullscreen"):this.fire("exitFullscreen")},destroy:function(){this.fullscreenChangeHandler.detach(),this.webkitFullscreenChangeHandler.detach(),this.mozFullscreenChangeHandler.detach(),this.msFullscreenChangeHandler.detach()}},e.augment(e.fluid.Fullscreen,e.EventTarget,!0,null,{prefix:"fullscreen"})},"@VERSION@",{requires:["event-custom"],optional:[],affinity:"client"});YUI.add("fluid-magic-slideshow-view",function(i){i.namespace("Views")[this.name]=i.Base.create("fluid-magic-slideshow-view",i.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.modelParams=e.photoListConfig.modelParams,this.pageParams=e.pageParams,this.modelParams.fetchParams&&(this.pageParams=i.merge(this.modelParams.fetchParams,this.pageParams)),this.pageParams.viewPageSize?this.positionMultipler=this.pageParams.viewPageSize:this.positionMultipler=this.pageParams.perPage,this},loadState:function(){var i=this;return this.appContext.getModel(this.modelParams.registryName,this.modelParams.modelIdOrAttributes,this.modelParams.fetchParams).then(function(e){i.position=(i.pageParams.nominalPage-1)*i.positionMultipler||0,i.collection=e.getValue("photoPageList"),i.isEnabled=i.collection.totalItems>0}).catch(function(i){})},buildContainer:function(){return this.setContainerWithTemplate("fluid-magic-slideshow",{isEnabled:this.isEnabled}),this},toggleSlideshow:function(e){i.rapidTracker.beacon(this.name,"launchSlideshow"),e.halt(),new i.Views.Slideshow({appContext:this.appContext,collection:this.collection,pageParams:this.pageParams,position:this.position}).show()},activate:function(){return this.isEnabled&&this.registerEventHandler(this.get("container").one(".slideshow-toggle").on("click",this.toggleSlideshow.bind(this))),this}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-fluid-magic-slideshow","slideshow-view"],langBundles:["common"]});YUI.add("album-toolbar-view",function(t){t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"fluid-magic-slideshow-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},initializer:function(t){return this.albumId=t.albumId,this.albumPhotoListLayoutStyle=t.albumPhotoListLayoutStyle,this.nsidOrPathAlias=t.nsidOrPathAlias,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var t=this;return t.appContext.getModel("set-models",t.albumId).then(function(e){t.set("albumModel",e)})},buildContainer:function(){var t=this.get("albumModel"),e=t.id,i=!1;return this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===t.getValue("owner").id&&(i=!0),this.setContainerWithTemplate("album-toolbar",{nsidOrPathAlias:this.nsidOrPathAlias,viewerIsOwner:i,setId:e,isJustifiedLayout:"justified"===this.albumPhotoListLayoutStyle,isStoryLayout:"story"===this.albumPhotoListLayoutStyle}),this},buildErrorContainer:function(){},activate:function(){var e=this.get("container"),i=this;return this.registerEventHandler(e.all(".layout").on("click",function(a){a.preventDefault();var l=a.target.getAttribute("data-layout");l!==i.layoutStyle&&(e.one(".selected").removeClass("selected"),a.target.addClass("selected"),t.fire("albumToolbarView:layoutChange",l),i.layoutStyle=l)})),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-album-toolbar","fluid-magic-slideshow-view"],optional:[],langBundles:["album-page","common"]});YUI.add("hermes-template-album-header",function(e,a){var t=e.Template.Handlebars.revive({1:function(e,a,t,l,n){var s,i=null!=a?a:{},r=t.helperMissing;return'\t\t<span class="edit-cover-photo" title="'+e.escapeExpression((t.intlMessage||a&&a.intlMessage||r).call(i,{name:"intlMessage",hash:{intlName:"album-page.EDIT_COVER"},data:n}))+'">\n\t\t\t<i></i>\n\t\t</span>\n'+(null!=(s=(t.isFlipped||a&&a.isFlipped||r).call(i,"enable-change-album-sorting",{name:"isFlipped",hash:{},fn:e.program(2,n,0),inverse:e.noop,data:n}))?s:"")},2:function(e,a,t,l,n){return'\t\t\t<span class="change-album-sorting">\n\t\t\t\t'+e.escapeExpression((t.intlMessage||a&&a.intlMessage||t.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"album-page.SORT"},data:n}))+"<i></i>\n\t\t\t</span>\n"},compiler:[7,">= 4.0.0"],main:function(e,a,t,l,n){var s,i,r=null!=a?a:{},u=t.helperMissing,o=e.escapeExpression;return'<div class="album-header-content" style="height: '+o("function"==typeof(i=null!=(i=t.height||(null!=a?a.height:a))?i:u)?i.call(r,{name:"height",hash:{},data:n}):i)+"px; background-image: url("+o("function"==typeof(i=null!=(i=t["cover-photo-url"]||(null!=a?a["cover-photo-url"]:a))?i:u)?i.call(r,{name:"cover-photo-url",hash:{},data:n}):i)+');">\n\n\t<div class="dimming-shim"></div>\n\t<div class="flex-padding"></div>\n\n'+(null!=(s=t.if.call(r,null!=a?a.viewerIsOwner:a,{name:"if",hash:{},fn:e.program(1,n,0),inverse:e.noop,data:n}))?s:"")+"\n\t"+o((t.outlet||a&&a.outlet||u).call(r,null!=a?a["album-title-desc-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\t"+o((t.outlet||a&&a.outlet||u).call(r,null!=a?a["album-stats-view"]:a,{name:"outlet",hash:{},data:n}))+"\n\t"+o((t.outlet||a&&a.outlet||u).call(r,null!=a?a["album-engagement-view"]:a,{name:"outlet",hash:{},data:n}))+'\n\t<div class="flex-padding"></div>\n\n\t'+o((t.outlet||a&&a.outlet||u).call(r,null!=a?a["attribution-view"]:a,{name:"outlet",hash:{},data:n}))+"\n</div>\n"},useData:!0}),l={};e.Array.each([],function(a){var t=e.Template.get("hermes/"+a);t&&(l[a]=t)}),e.Template.register("hermes/album-header",function(a,n){return n=n||{},n.partials=n.partials?e.merge(l,n.partials):l,t(a,n)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-album-title-desc",function(e,n){var a=e.Template.Handlebars.revive({1:function(e,n,a,t,l){return"editable"},3:function(e,n,a,t,l){return'\t\t<span class="title-desc-edit" data-action="edit" title="'+e.escapeExpression((a.intlMessage||n&&n.intlMessage||a.helperMissing).call(null!=n?n:{},{name:"intlMessage",hash:{intlName:"common.EDIT"},data:l}))+'"></span>\n'},5:function(e,n,a,t,l){return"description-placeholder"},7:function(e,n,a,t,l){return"\t\t\t"+e.escapeExpression((a.renderTrustedMarkup||n&&n.renderTrustedMarkup||a.helperMissing).call(null!=n?n:{},null!=n?n.description:n,{name:"renderTrustedMarkup",hash:{},data:l}))+"\n"},9:function(e,n,a,t,l){var i;return null!=(i=a.if.call(null!=n?n:{},null!=n?n.canEdit:n,{name:"if",hash:{},fn:e.program(10,l,0),inverse:e.noop,data:l}))?i:""},10:function(e,n,a,t,l){return"\t\t\t\t"+e.escapeExpression((a.intlMessage||n&&n.intlMessage||a.helperMissing).call(null!=n?n:{},{name:"intlMessage",hash:{intlName:"album-page.ALBUM_ADD_DESCRIPTION"},data:l}))+"\n"},12:function(e,n,a,t,l){return'\t<button class="done-editing-album-title-desc hidden" data-action="saveAlbumTitleDescEdit">'+e.escapeExpression((a.intlMessage||n&&n.intlMessage||a.helperMissing).call(null!=n?n:{},{name:"intlMessage",hash:{intlName:"common.DONE"},data:l}))+"</button>\n"},compiler:[7,">= 4.0.0"],main:function(e,n,a,t,l){var i,s,r=null!=n?n:{},d=a.helperMissing,o=e.escapeExpression;return'<div class="title-desc-block '+(null!=(i=a.if.call(r,null!=n?n.canEdit:n,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l}))?i:"")+'">\n\t<div class="'+(null!=(i=a.if.call(r,null!=n?n.canEdit:n,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l}))?i:"")+' album-title">\n\t\t'+o("function"==typeof(s=null!=(s=a.title||(null!=n?n.title:n))?s:d)?s.call(r,{name:"title",hash:{},data:l}):s)+"\n\t</div>\n\n"+(null!=(i=a.if.call(r,null!=n?n.canEdit:n,{name:"if",hash:{},fn:e.program(3,l,0),inverse:e.noop,data:l}))?i:"")+'\n\t<input type="text" class="meta-field edit-meta-field edit-album-title" wrap="on"></input>\n\n\t<div class="'+(null!=(i=a.if.call(r,null!=n?n.canEdit:n,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l}))?i:"")+" album-desc "+(null!=(i=a.unless.call(r,null!=n?n.description:n,{name:"unless",hash:{},fn:e.program(5,l,0),inverse:e.noop,data:l}))?i:"")+'">\n'+(null!=(i=a.if.call(r,null!=n?n.description:n,{name:"if",hash:{},fn:e.program(7,l,0),inverse:e.program(9,l,0),data:l}))?i:"")+'\t</div>\n\n\t<div class="description-show-more hidden">\n\t\t<span class="description-show-more-link '+(null!=(i=a.if.call(r,null!=n?n.canEdit:n,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.noop,data:l}))?i:"")+'" data-action="showMore">\n\t\t\t'+o((a.intlMessage||n&&n.intlMessage||d).call(r,{name:"intlMessage",hash:{intlName:"common.SHOW_MORE"},data:l}))+'\n\t\t</span>\n\t</div>\n\n\t<textarea class="meta-field edit-meta-field edit-album-desc" wrap="on"></textarea>\n</div>\n\n'+(null!=(i=a.if.call(r,null!=n?n.canEdit:n,{name:"if",hash:{},fn:e.program(12,l,0),inverse:e.noop,data:l}))?i:"")},useData:!0}),t={};e.Array.each([],function(n){var a=e.Template.get("hermes/"+n);a&&(t[n]=a)}),e.Template.register("hermes/album-title-desc",function(n,l){return l=l||{},l.partials=l.partials?e.merge(t,l.partials):t,a(n,l)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("album-title-desc-view",function(e){var t={bigFont:"26px",smallFont:"18px",heightOfOneLineOfTextUsingBigFont:29,maxNumberOfLinesOfDescriptionToShow:2,maxNumberOfLinesOfDescriptionToShowJustified:1,maxNumberOfLinesOfDescriptionToShowInEditField:4,currentDescriptionEditableFieldHeight:29,heightOfOneLineOfTextWhenJustified:29};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.albumId=e.albumId,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var e=this;return e.appContext.getModel("set-models",e.albumId).then(function(t){e.set("albumModel",t)})},wrapDescription:function(e){return e=e.split("\n"),e.length>1&&e.forEach(function(e,t,i){i[t]=e+"<br>"}),e.join("")},doneEditingTitleDescription:function(){var i,s,a=this,n=this.get("albumModel"),o=a.intlMessage({intlName:"album-page.ALBUM_ADD_DESCRIPTION"}),l=n.getValue("title").trim(),d=n.getValue("description").trim(),r=this.get("container"),c=r.one(".album-desc"),h=r.one(".album-title"),u=r.one(".edit-album-desc"),m=r.one(".edit-album-title"),g=r.one(".done-editing-album-title-desc");r.removeClass("editing"),""===(i=m.get("value").trim())&&(i=l),s=u.get("value")!==o?u.get("value").trim():"",g.addClass("hidden"),a.fire("subviewViewEvent","albumTitleDesc:doneEditing"),i!==l||s!==d?(n.setValue("title",i),n.setValue("description",s),e.rapidTracker.beacon(a.name,"albumTitleDescriptionSave"),n.remoteUpdate().then(function(){var e=n.getValue("title"),i=n.getValue("description");h.set("text",e),""!==i.trim()?(c.removeClass("description-placeholder"),i=a.wrapDescription(i),c.setHTML(i)):(c.addClass("description-placeholder"),c.setHTML(o)),m.removeClass("show-editable"),u.removeClass("show-editable"),h.removeClass("hidden"),c.removeClass("hidden"),r.hasClass("justified")?a.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShowJustified):a.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShow)},function(e){n.setValue("title",l),n.setValue("description",d),h.set("text",l),""!==d.trim()?(c.removeClass("description-placeholder"),c.setHTML(d)):(c.addClass("description-placeholder"),c.setHTML(o)),m.removeClass("show-editable"),u.removeClass("show-editable"),h.removeClass("hidden"),c.removeClass("hidden"),r.hasClass("justified")?a.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShowJustified):a.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShow),a.onError(a.intlMessage({intlName:"album-page.ERROR_UPDATING_ALBUM_TITLE_DESCRIPTION"}))})):(m.removeClass("show-editable"),u.removeClass("show-editable"),h.removeClass("hidden"),""===s.trim()?(c.addClass("description-placeholder"),c.setHTML(o)):(s=a.wrapDescription(s),c.removeClass("description-placeholder"),c.setHTML(s)),c.removeClass("hidden"),r.hasClass("justified")?a.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShowJustified):a.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShow)),r.hasClass("justified")&&t.currentDescriptionEditableFieldHeight!==t.heightOfOneLineOfTextWhenJustified&&(a.fire("subviewViewEvent","albumTitleDescEditing:heightChange",t.heightOfOneLineOfTextWhenJustified-t.currentDescriptionEditableFieldHeight),t.currentDescriptionEditableFieldHeight=t.heightOfOneLineOfTextWhenJustified)},editTitleDescription:function(t){var i,s,a=this.get("container"),n=this.intlMessage({intlName:"album-page.ALBUM_ADD_DESCRIPTION"}),o=a.one(".album-title"),l=a.one(".edit-album-desc"),d=a.one(".edit-album-title"),r=this.get("albumModel"),c=r.getValue("title"),h=r.getValue("description").trim(),u=a.one(".description-show-more"),m=a.one(".done-editing-album-title-desc");(t.target.hasClass("editable album-title")||t.target.hasClass("editable album-desc")||t.target.ancestor().hasClass("editable album-desc")||t.target.hasClass("title-desc-edit")||t.target.hasClass("description-show-more-link editable")||t.target.hasClass("title-desc-block editable"))&&"a"!==t.target.get("tagName").toLowerCase()&&(t.preventDefault(),t.stopPropagation(),a.addClass("editing"),u.addClass("hidden"),this.fire("subviewViewEvent","albumTitleDesc:editing"),m.removeClass("hidden"),i=o.getXY(),d.set("value",c),d.setStyle("height",o.get("offsetHeight")),d.setStyle("width",o.get("offsetWidth")),d.setStyle("left",i[0]),d.setStyle("top",i[1]),o.addClass("hidden"),d.addClass("show-editable"),h?(s=h.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<"),l.removeClass("description-placeholder")):(s=n,l.addClass("description-placeholder")),l.set("value",s),this.makeDescriptionEditFieldResponsive(),t.target.hasClass("editable album-title")?d.focus():l.focus(),e.rapidTracker.beacon(this.name,"albumTitleDescriptionEdit"))},makeDescriptionEditFieldResponsive:function(){var e,i,s,a,n,o=this.get("container"),l=o.one(".album-desc"),d=o.one(".edit-album-desc"),r=d.get("value"),c=!1;o.hasClass("justified")&&(c=!0),r?(r=r.replace(/"/g,"&quot;").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),r=this.wrapDescription(r),l.addClass("calculating").removeClass("hidden"),l.setHTML(r),(i=parseInt(l.getComputedStyle("height"),10))>t.heightOfOneLineOfTextUsingBigFont*t.maxNumberOfLinesOfDescriptionToShowInEditField?d.setStyle("height",t.heightOfOneLineOfTextUsingBigFont*t.maxNumberOfLinesOfDescriptionToShowInEditField):d.setStyle("height",i),c&&(n=parseInt(d.getComputedStyle("height"),10))!==t.currentDescriptionEditableFieldHeight&&(e=n-t.currentDescriptionEditableFieldHeight,this.fire("subviewViewEvent","albumTitleDescEditing:heightChange",e),t.currentDescriptionEditableFieldHeight=n),s=l.get("offsetWidth"),a=l.getXY(),d.setStyle("width",s),d.setStyle("left",a[0]),d.setStyle("top",a[1]),l.addClass("hidden").removeClass("calculating"),d.addClass("show-editable")):(d.setStyle("height",t.heightOfOneLineOfTextUsingBigFont),l.addClass("hidden").removeClass("calculating"))},displayShowMoreIfNeeded:function(e){var i,s=this.get("container"),a=s.one(".album-desc"),n=s.one(".title-desc-block"),o=s.one(".description-show-more");a&&((i=a.cloneNode(!0)).removeClass("album-desc"),i.addClass("album-desc-calculator"),n.append(i),parseInt(i.getComputedStyle("height"),10)>t.heightOfOneLineOfTextUsingBigFont*e?o.removeClass("hidden"):o.addClass("hidden"),i.remove(!0))},showMoreClick:function(t){var i=this.get("albumModel").getValue("description"),s=this.get("container").one(".description-show-more");i=this.wrapDescription(i),t.target.hasClass("editable")?(s.addClass("hidden"),this.editTitleDescription(t)):new e.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"album-page.ALBUM_DESCRIPTION"}),message:i,actionButtonLabel:this.intlMessage({intlName:"common.OK"}),showCancelButton:!1,classList:"album-full-description"}).show()},buildContainer:function(){var e=this.get("albumModel"),t=e.getValue("title"),i=e.getValue("description"),s=e.getValue("isAutoUploadSet"),a=!1,n=!1,o=this.get("container");return""!==i.trim()&&(n=!0,"justified"===this.albumPhotoListLayoutStyle&&o.addClass("justified"),i=this.wrapDescription(i)),this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===e.getValue("owner").id&&!s&&(a=!0),this.setContainerWithTemplate("album-title-desc",{title:t,description:i,hasDescription:n,canEdit:a}),this},buildErrorContainer:function(){},activate:function(){var i=this,s=this.get("albumModel"),a=this.get("container"),n=i.intlMessage({intlName:"album-page.ALBUM_ADD_DESCRIPTION"}),o=a.one(".title-desc-block"),l=a.one(".edit-album-title"),d=a.one(".edit-album-desc"),r=a.one(".title-desc-edit"),c=a.one(".description-show-more-link"),h=!1;return this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===s.getValue("owner").id&&(h=!0),a.hasClass("justified")?i.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShowJustified):i.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShow),h&&!s.getValue("isAutoUploadSet")&&(i.registerEventHandler(o.on("click",function(e){i.editTitleDescription(e)},o)),i.registerEventHandler(r.on("click",function(e){i.editTitleDescription(e)},r))),i.registerEventHandler(c.on("click",function(e){i.showMoreClick(e)},c)),this.registerEventHandler(l.on("keyup",function(e){13===e.keyCode&&i.doneEditingTitleDescription()},this)),this.registerEventHandler(l.on("blur",function(t){setTimeout(function(){try{e.config.doc.activeElement.isEqualNode(l.getDOMNode())||e.config.doc.activeElement.classList.contains("edit-album-desc")||i.doneEditingTitleDescription()}catch(e){}},1,l)},this)),this.registerEventHandler(d.on("keyup",function(e){i.makeDescriptionEditFieldResponsive()},this)),this.registerEventHandler(d.on("blur",function(t){""===d.get("value").trim()?(d.addClass("description-placeholder"),d.set("value",n)):d.removeClass("description-placeholder"),setTimeout(function(){try{e.config.doc.activeElement.isEqualNode(d.getDOMNode())||e.config.doc.activeElement.classList.contains("edit-album-title")||i.doneEditingTitleDescription()}catch(e){}},1,d)},this)),this.registerEventHandler(d.on("focus",function(){d.get("value").trim()===n&&(d.removeClass("description-placeholder"),d.set("value",""))},this)),e.on("albumToolbarView:layoutChange",function(e){"justified"===e?(a.addClass("justified"),i.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShowJustified)):(a.removeClass("justified"),i.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShow))}),this},onError:function(t){return this.errorDialog=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!1,title:this.intlMessage({intlName:"common.OOPS"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),message:t,darkOverlay:!0}),this.errorDialog.show(),this.errorDialog}})},"@VERSION@",{requires:["flickr-view","hermes-template-album-title-desc","handlebars-helpers"],optional:[],langBundles:["common","album-page"]});YUI.add("hermes-template-album-stats",function(e,a){var s=e.Template.Handlebars.revive({1:function(e,a,s,n,t){return'\t\t<span class="photo-counts">'+e.escapeExpression((s.intlMessage||a&&a.intlMessage||s.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{selectedCount:null!=a?a.photosArePresent:a,intlName:"album-page.PHOTOS_COUNT"},data:t}))+"</span>\n"},3:function(e,a,s,n,t){var l,r=null!=a?a:{};return(null!=(l=s.if.call(r,null!=a?a.photosArePresent:a,{name:"if",hash:{},fn:e.program(4,t,0),inverse:e.noop,data:t}))?l:"")+'\t\t<span class="video-counts">'+e.escapeExpression((s.intlMessage||a&&a.intlMessage||s.helperMissing).call(r,{name:"intlMessage",hash:{selectedCount:null!=a?a.videosArePresent:a,intlName:"album-page.VIDEOS_COUNT"},data:t}))+"</span>\n"},4:function(e,a,s,n,t){return'\t\t\t<span class="album-stats-separator">&middot;</span>\n'},6:function(e,a,s,n,t){return'\t\t<span class="album-stats-separator">&middot;</span>\n\t\t<span class="view-counts">'+e.escapeExpression((s.intlMessage||a&&a.intlMessage||s.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{selectedCount:null!=a?a.viewsArePresent:a,intlName:"album-page.VIEWS_COUNT"},data:t}))+"</span>\n"},compiler:[7,">= 4.0.0"],main:function(e,a,s,n,t){var l,r=null!=a?a:{};return'<div class="stats-container">\n'+(null!=(l=s.if.call(r,null!=a?a.photosArePresent:a,{name:"if",hash:{},fn:e.program(1,t,0),inverse:e.noop,data:t}))?l:"")+(null!=(l=s.if.call(r,null!=a?a.videosArePresent:a,{name:"if",hash:{},fn:e.program(3,t,0),inverse:e.noop,data:t}))?l:"")+(null!=(l=s.if.call(r,null!=a?a.viewsArePresent:a,{name:"if",hash:{},fn:e.program(6,t,0),inverse:e.noop,data:t}))?l:"")+"</div>\n"},useData:!0}),n={};e.Array.each([],function(a){var s=e.Template.get("hermes/"+a);s&&(n[a]=s)}),e.Template.register("hermes/album-stats",function(a,t){return t=t||{},t.partials=t.partials?e.merge(n,t.partials):n,s(a,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("album-stats-view",function(t){t.FlickrView.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.albumId=t.albumId,this.albumPhotoListLayoutStyle=t.albumPhotoListLayoutStyle,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var t=this;return t.appContext.getModel("set-models",t.albumId).then(function(e){t.set("albumModel",e)})},buildContainer:function(){var t=this.get("albumModel"),e=t.getValue("photoCount"),i=t.getValue("videoCount"),n=t.getValue("viewCount"),a=this.get("container");return"justified"===this.albumPhotoListLayoutStyle&&a.addClass("justified"),this.setContainerWithTemplate("album-stats",{photosArePresent:e,videosArePresent:i,viewsArePresent:n}),this},buildErrorContainer:function(){},activate:function(){return this},onParentViewEvent:function(t,e){var i=this.get("container");return"album-stats-view"===t&&"albumHeaderView:editing"===e[0]?(i.addClass("invisible"),!1):"album-stats-view"===t&&"albumHeaderView:doneEditing"===e[0]?(i.removeClass("invisible"),!1):void 0}})},"@VERSION@",{requires:["flickr-view","hermes-template-album-stats"],optional:[],langBundles:["common","album-page"]});YUI.add("hermes-template-album-engagement",function(e,a){var n=e.Template.Handlebars.revive({1:function(e,a,n,l,t){return'\t<div class="create-book-container">\n\t\t<span class="create-book-icon" title="'+e.escapeExpression((n.intlMessage||a&&a.intlMessage||n.helperMissing).call(null!=a?a:{},{name:"intlMessage",hash:{intlName:"album-page.CREATE_BOOK_FROM_ALBUM"},data:t}))+'"></span>\n\t</div>\n'},3:function(e,a,n,l,t){return'\t<div class="download-album-container">\n\t\t<span class="download-album-icon"></span>\n\t</div>\n'},compiler:[7,">= 4.0.0"],main:function(e,a,n,l,t){var s,r=null!=a?a:{};return e.escapeExpression((n.outlet||a&&a.outlet||n.helperMissing).call(r,null!=a?a["fluid-share-album-view"]:a,{name:"outlet",hash:{},data:t}))+"\n\n"+(null!=(s=n.if.call(r,null!=a?a.viewerIsOwner:a,{name:"if",hash:{},fn:e.program(1,t,0),inverse:e.noop,data:t}))?s:"")+"\n\n"+(null!=(s=n.if.call(r,null!=a?a.enableDownload:a,{name:"if",hash:{},fn:e.program(3,t,0),inverse:e.noop,data:t}))?s:"")},useData:!0}),l={};e.Array.each([],function(a){var n=e.Template.get("hermes/"+a);n&&(l[a]=n)}),e.Template.register("hermes/album-engagement",function(a,t){return t=t||{},t.partials=t.partials?e.merge(l,t.partials):l,n(a,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});